<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyB235hCAouus9JhFLpWJ64DiXVvNaGYNm0",
    authDomain: "epicshutterhub-ee0d9.firebaseapp.com",
    projectId: "epicshutterhub-ee0d9",
    storageBucket: "epicshutterhub-ee0d9.firebasestorage.app",
    messagingSenderId: "49117682378",
    appId: "1:49117682378:web:7ebc026bb467eac04ab233",
    measurementId: "G-WV4SM92954"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

// Use the same Firebase config you used in admin panel
firebase.initializeApp(firebaseConfig);

const db = firebase.firestore();

// Fetch all products
db.collection("products")
  .orderBy("createdAt", "desc")
  .onSnapshot((snapshot) => {
    const container = document.getElementById("products");
    container.innerHTML = "";

    snapshot.forEach(doc => {
      const p = doc.data();

      container.innerHTML += `
             <div class="product-card fade-in-up animated" data-name="${p.name}">
                <div class="product-image">
                    <img height="100%" width="100%" src="${p.images[0]}" loading="lazy" alt="${p.name}"></div>
                <div class="product-info">
                    <span class="product-category">${p.cat}</span>
                    <h3 class="product-name">${p.name}</h3>
                    <p class="product-description">${p.description}</p>
                    <div class="product-price">${p.price}</div>
                    <button class="add-to-cart" data-product="${p.name}" data-price="${p.price}">Add to Cart</button>
                </div>
            </div>
      `;
    });
  });
  // for fetching categories
    function fetchCategory(cat){
    db.collection("products").where("category","==",cat)
      .onSnapshot(snapshot=>{
        const container = document.getElementById("products");
        container.innerHTML="";
        snapshot.forEach(doc=>{
          const p = doc.data();
          container.innerHTML += `
            <div class="product-card">
              <img src="${p.images[0]}">
              <h3>${p.name}</h3>
              <p>${p.description}</p>
              <strong>$${p.price}</strong>
            </div>
          `;
        });
      });
  }

</script>
